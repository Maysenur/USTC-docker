FROM ubuntu:20.04

# Non-interactive mode for apt
# Auto - yes
ENV DEBIAN_FRONTEND=noninteractive

# Essential packages
RUN apt-get update && apt-get install -y \
    wget curl git apt-transport-https ca-certificates software-properties-common \
    python3 python3-dev python3-pip fdupes unzip nano \
    gnupg2 dirmngr \
    && rm -rf /var/lib/apt/lists/*

# Mono installation
RUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 3FA7E0328081BFF6A14DA29AA6A19B38D3D831EF \
    && echo "deb https://download.mono-project.com/repo/ubuntu stable-focal main" | tee /etc/apt/sources.list.d/mono-official-stable.list \
    && apt-get update && apt-get install -y mono-devel \
    && rm -rf /var/lib/apt/lists/*

# Working directory
WORKDIR /usr/src/app

# Clone the repository
RUN git clone -b ubuntu https://github.com/yungshenglu/USTC-TK2016.git .

# Overwrite-update requirements
RUN echo -e "numpy>=1.16.4\nPillow==6.2.2" > /usr/src/app/requirements.txt

# Install Python dependencies
RUN python3 -m pip install --upgrade pip \
    && pip3 install --no-cache-dir -r /usr/src/app/requirements.txt

# When container runs start bash
CMD ["/bin/bash"]
